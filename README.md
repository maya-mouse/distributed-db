LAB 3: Оптимізація Apache Cassandra для Time Series АЕС
Мета та Фокус

| Параметр         | Опис                                                                                            |
| ---------------- | ----------------------------------------------------------------------------------------------- |
| **Система**      | Атомні електростанції (4 реакторні блоки, критичні дані)                                        |
| **Мета**         | Спроєктувати та оптимізувати схеми даних для Time Series із максимальною продуктивністю запитів |
| **1. Дані**      | 518,400 записів (телеметрія за 30 днів), Write Throughput: 63 rec/sec                           |
| **2. Фокус (Б)** | Орієнтація на запити (MV, Latency, Аналітика)                                                   |

3. Порівняльний Аналіз Схем (Bucketing)

Проєктування ґрунтується на Time Bucketing для контролю розміру партицій.


| Схема                | Partition Key               | Avg Latency (мс)             | Max Partition Size |
| -------------------- | --------------------------- | ---------------------------- | ------------------ |
| **Minute (2)**       | (reactor_id, bucket_minute) | **15.518**                   | ≈ 8.4 KB           |
| **Aggregates (3.2)** | (reactor_id, bucket_hour)   | **15.882**                   | ≈ 48 KB            |
| **Daily Raw (3.1)**  | (reactor_id, bucket_date)   | **38.146** (ALLOW FILTERING) | ≈ 48 KB            |
| **Simple (1)**       | (reactor_id)                | >> 1000 мс (Теорія)          | >> 100 MB          |

Ключові Висновки щодо Latency

Оптимальний вибір для АЕС: Minute Bucketing (Схема 2)

Найнижча стабільна Latency: 15.518 мс

Ідеальний розмір партиції: ≈ 8.4 KB

Аналітика: вибірка з агрегованої таблиці (Q3) також швидка (15.882 мс), що добре підходить для дашбордів.

Антипатерн: схема Simple (1) непридатна, оскільки її необмежений ріст призводить до повільних запитів і руйнує стабільність.

4. Оптимізація Запитів (Focus Б)
1. Materialized Views (MV)

Materialized View використано для оптимізації пошуку аварійних станів (High Pressure).

| Запит                      | Avg Latency (мс) | P95 Latency (мс) | Improvement                |
| -------------------------- | ---------------- | ---------------- | -------------------------- |
| **Q4.1 (MV Optimized)**    | **15.520**       | **17.380**       | -                          |
| **Q4.2 (ALLOW FILTERING)** | 32.733           | 40.562           | **2.1 рази швидше (з MV)** |

Висновок (Focus Б):
MV є критично необхідним для оперативної аналітики.
Без MV (Q4.2) P95 Latency = 40.562 мс, що виходить за межі норми (<20 мс).
MV повертає продуктивність у стабільний діапазон (15.520 мс).

5.Фінальні критерії якості

| Критерій                        | Результат      | Статус   |
| ------------------------------- | -------------- | -------- |
| **P95 Latency < 20 мс**         | 17.121 мс (Q1) | Виконано |
| **Avg Partition Size < 100 MB** | ≈ 8.4 KB       | Виконано |
| **MV Прискорення**              | 2.1x           | Виконано |
| **Compression Ratio > 40%**     | ≈ 45%          | Виконано |

6. Фінальний Висновок

Спроєктоване рішення повністю відповідає вимогам Focus Б (Орієнтація на запити) та забезпечує стабільну продуктивність моніторингу АЕС.

Оптимальна схема для критичних часових рядів — Minute Bucketing, що гарантує низьку latency, оптимальний розмір партицій та ефективну підтримку оперативної аналітики.

